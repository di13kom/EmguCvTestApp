<Window x:Class="EmguWpfApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:EmguWpfApp"
        mc:Ignorable="d"
        Title="MainWindow" Height="650" Width="530">
    <Window.Resources>
        <local:SyncConverter x:Key="SyncConverter" />
        <local:ValueConverter x:Key="ValueConverter"/>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition MaxHeight="20"></RowDefinition>
            <RowDefinition MaxHeight="100"></RowDefinition>
            <RowDefinition MaxHeight="100"></RowDefinition>
            <RowDefinition MaxHeight="30"></RowDefinition>
            <RowDefinition MaxHeight="100"></RowDefinition>
            <RowDefinition MaxHeight="100"></RowDefinition>
            <RowDefinition></RowDefinition>
        </Grid.RowDefinitions>
        <DockPanel Grid.Row="0">
            <Menu DockPanel.Dock="Top">
                <MenuItem Header="File">
                    <MenuItem Header="_Open" Click="MenuItemOpen_Click"/>
                </MenuItem>
            </Menu>
        </DockPanel>
        <StackPanel x:Name="Panel1" Grid.Row="1" Margin="10,0,10,0" HorizontalAlignment="Stretch">
            <Label HorizontalAlignment="Center" FontWeight="Bold">ColorMin</Label>
            <DockPanel>
                <Label>B</Label>
                <Slider x:Name="ColorMin_blue" Minimum="0" Maximum="255" MinWidth="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight" 
                        TickFrequency="1" Value="0" ValueChanged="Color_ValueChanged"/>
                <TextBox Text="{Binding ElementName=ColorMin_blue,Path=Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
            <DockPanel>
                <Label>G</Label>
                <Slider x:Name="ColorMin_green" Minimum="0" Maximum="255" MinWidth="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight" 
                        TickFrequency="1" Value="0" ValueChanged="Color_ValueChanged"/>
                <TextBox Text="{Binding ElementName=ColorMin_green,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
            <DockPanel>
                <Label>R</Label>
                <Slider x:Name="ColorMin_red" Minimum="0" Maximum="255" MinWidth="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight" 
                        TickFrequency="1" Value="0" ValueChanged="Color_ValueChanged"/>
                <TextBox Text="{Binding ElementName=ColorMin_red,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25" />
            </DockPanel>
        </StackPanel>
        <StackPanel x:Name="Panel2" Grid.Row="2" Margin="10,0,10,0">
            <Label HorizontalAlignment="Center" FontWeight="Bold">ColorMax</Label>
            <DockPanel>
                <Label>B</Label>
                <Slider x:Name="ColorMax_blue" Minimum="0" Maximum="255" Width="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight"
                        TickFrequency="1" Value="255" ValueChanged="Color_ValueChanged"/>
                <TextBox Text="{Binding ElementName=ColorMax_blue,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
            <DockPanel>
                <Label>G</Label>
                <Slider x:Name="ColorMax_green" Minimum="0" Maximum="255" Width="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight"
                        TickFrequency="1" Value="255" ValueChanged="Color_ValueChanged"/>
                <TextBox Text="{Binding ElementName=ColorMax_green,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
            <DockPanel>
                <Label>R</Label>
                <Slider x:Name="ColorMax_red" Minimum="0" Maximum="255" Width="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight"
                        TickFrequency="1" Value="255" ValueChanged="Color_ValueChanged"/>
                <TextBox Text="{Binding ElementName=ColorMax_red,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
        </StackPanel>
        <Border Grid.Row="3" HorizontalAlignment="Stretch" BorderThickness="1" Background="GhostWhite" BorderBrush="Gainsboro">
            <DockPanel HorizontalAlignment="Center"  VerticalAlignment="Center">
                <CheckBox x:Name="ColorMask_Sync" IsChecked="True" Margin="5"/>
                <Label>Synchronize ColorRange and ColorMask?</Label>
            </DockPanel>
        </Border>
        <StackPanel x:Name="Panel3" Grid.Row="4" Margin="10,0,10,0" IsEnabled="{Binding Path=IsChecked, ElementName=ColorMask_Sync,Converter={StaticResource SyncConverter}}">
            <Label HorizontalAlignment="Center" FontWeight="Bold">MaskMin</Label>
            <DockPanel>
                <Label>B</Label>
                <Slider x:Name="MaskMin_blue" Minimum="0" Maximum="255" Width="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight"
                        TickFrequency="1" ValueChanged="Color_ValueChanged">
                    <Slider.Value>
                        <MultiBinding Converter="{StaticResource ValueConverter}">
                            <Binding Path="IsEnabled" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" ElementName="ColorMin_blue"/>
                        </MultiBinding>
                    </Slider.Value>
                </Slider>
                <TextBox Text="{Binding ElementName=MaskMin_blue,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
            <DockPanel>
                <Label>G</Label>
                <Slider x:Name="MaskMin_green" Minimum="0" Maximum="255" Width="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight"
                        TickFrequency="1" ValueChanged="Color_ValueChanged">
                    <Slider.Value>
                        <MultiBinding Converter="{StaticResource ValueConverter}">
                            <Binding Path="IsEnabled" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" ElementName="ColorMin_green"/>
                        </MultiBinding>
                    </Slider.Value>
                </Slider>
                <TextBox Text="{Binding ElementName=MaskMin_green,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
            <DockPanel>
                <Label>R</Label>
                <Slider x:Name="MaskMin_red" Minimum="0" Maximum="255" Width="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight"
                        TickFrequency="1" ValueChanged="Color_ValueChanged">
                    <Slider.Value>
                        <MultiBinding Converter="{StaticResource ValueConverter}">
                            <Binding Path="IsEnabled" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" ElementName="ColorMin_red"/>
                        </MultiBinding>
                    </Slider.Value>
                </Slider>
                <TextBox Text="{Binding ElementName=MaskMin_red,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
        </StackPanel>
        <StackPanel x:Name="Panel4" Grid.Row="5" Margin="10,0,10,0" IsEnabled="{Binding Path=IsChecked, ElementName=ColorMask_Sync,Converter={StaticResource SyncConverter}}">
            <Label HorizontalAlignment="Center" FontWeight="Bold">MaskMax</Label>
            <DockPanel>
                <Label>B</Label>
                <Slider x:Name="MaskMax_blue" Minimum="0" Maximum="255" Width="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight" 
                        TickFrequency="1" ValueChanged="Color_ValueChanged">
                    <Slider.Value>
                        <MultiBinding Converter="{StaticResource ValueConverter}">
                            <Binding Path="IsEnabled" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" ElementName="ColorMax_blue"/>
                        </MultiBinding>
                    </Slider.Value>
                </Slider>
                <TextBox Text="{Binding ElementName=MaskMax_blue,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
            <DockPanel>
                <Label>G</Label>
                <Slider x:Name="MaskMax_green" Minimum="0" Maximum="255" Width="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight" 
                        TickFrequency="1" ValueChanged="Color_ValueChanged">
                    <Slider.Value>
                        <MultiBinding Converter="{StaticResource ValueConverter}">
                            <Binding Path="IsEnabled" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" ElementName="ColorMax_green"/>
                        </MultiBinding>
                    </Slider.Value>
                </Slider>
                <TextBox Text="{Binding ElementName=MaskMax_green,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
            <DockPanel>
                <Label>R</Label>
                <Slider x:Name="MaskMax_red" Minimum="0" Maximum="255" Width="450" IsSnapToTickEnabled="True" TickPlacement="BottomRight"
                        TickFrequency="1" ValueChanged="Color_ValueChanged">
                    <Slider.Value>
                        <MultiBinding Converter="{StaticResource ValueConverter}">
                            <Binding Path="IsEnabled" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" RelativeSource="{RelativeSource Mode=Self}"/>
                            <Binding Path="Value" ElementName="ColorMax_red"/>
                        </MultiBinding>
                    </Slider.Value>
                </Slider>
                <TextBox Text="{Binding ElementName=MaskMax_red,Path=Value,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="25"/>
            </DockPanel>
        </StackPanel>
        <Border Grid.Row="6" MinHeight="100" Margin="5" BorderThickness="2" Background="GhostWhite" BorderBrush="Gainsboro">
            <Image x:Name="ImageViewer" />
        </Border>
    </Grid>
</Window>
